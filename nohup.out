[36m[reset] killing old local api/worker (if any) ...[0m
[36m[reset] docker compose down -v (db/redis) ...[0m
 Container apisharayeh-redis-1  Stopping
 Container apisharayeh-db-1  Stopping
 Container apisharayeh-db-1  Stopped
 Container apisharayeh-db-1  Removing
 Container apisharayeh-db-1  Removed
 Container apisharayeh-redis-1  Stopped
 Container apisharayeh-redis-1  Removing
 Container apisharayeh-redis-1  Removed
 Network apisharayeh_default  Removing
 Volume apisharayeh_pg_data  Removing
 Volume apisharayeh_pg_data  Removed
 Network apisharayeh_default  Removed
[36m[venv] creating/upgrading virtualenv & installing deps ...[0m
[36m[env] ensuring .env has correct connection strings ...[0m
[36m[env] .env summary:[0m
  DATABASE_URL=postgresql+asyncpg://agentic:agentic@localhost:5432/agentic
  DATABASE_URL_SYNC=postgresql+psycopg2://agentic:agentic@localhost:5432/agentic
  REDIS_URL=redis://localhost:6379/1
  REDIS_URL_QUEUE=redis://localhost:6379/2
  PUBLIC_BASE_URL=http://localhost:8081
  PLUGINS_DIR=./plugins
  ARTIFACTS_DIR=./artifacts
  SERVICE_FLAGS=*
  SOFFICE_BIN=/Applications/LibreOffice.app/Contents/MacOS/soffice
[36m[infra] starting db + redis ...[0m
 Network apisharayeh_default  Creating
 Network apisharayeh_default  Created
 Volume "apisharayeh_pg_data"  Creating
 Volume "apisharayeh_pg_data"  Created
 Container apisharayeh-redis-1  Creating
 Container apisharayeh-db-1  Creating
 Container apisharayeh-db-1  Created
 Container apisharayeh-redis-1  Created
 Container apisharayeh-db-1  Starting
 Container apisharayeh-redis-1  Starting
 Container apisharayeh-redis-1  Started
 Container apisharayeh-db-1  Started
[36m[infra] waiting for Postgres healthcheck ...[0m
[32m[infra] db is healthy.[0m
[36m[migrate] running alembic upgrade head ...[0m
[migrate] using config: /Users/omair/apisharayeh/src/db/alembic.ini
[migrate] database: postgresql+psycopg2://agentic:agentic@localhost:5432/agentic
INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.
INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.
INFO  [alembic.runtime.migration] Will assume transactional DDL.
INFO  [alembic.runtime.migration] Will assume transactional DDL.
0008_jobs_heartbeat (head)
INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.
INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.
INFO  [alembic.runtime.migration] Will assume transactional DDL.
INFO  [alembic.runtime.migration] Will assume transactional DDL.
INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.
INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.
INFO  [alembic.runtime.migration] Will assume transactional DDL.
INFO  [alembic.runtime.migration] Will assume transactional DDL.
0008_jobs_heartbeat (head)
[36m[run] starting API & Worker in background ...[0m
[36m[wait] waiting for API on :8081 (tailing logs/api.out) ...[0m
[api] 2025-08-24 22:08:31 PWD=/Users/omair/apisharayeh
[api] 2025-08-24 22:08:31 PYTHONPATH=src:
[api] 2025-08-24 22:08:31 DATABASE_URL=postgresql+asyncpg://agentic:agentic@localhost:5432/agentic
[api] 2025-08-24 22:08:31 REDIS_URL=redis://localhost:6379/1
[api] 2025-08-24 22:08:31 PLUGINS_DIR=./plugins
[api] 2025-08-24 22:08:31 ARTIFACTS_DIR=./artifacts
[api] 2025-08-24 22:08:31 SERVICE_FLAGS=*
[api] 2025-08-24 22:08:31 PUBLIC_BASE_URL=http://localhost:8081
[api] 2025-08-24 22:08:31 SOFFICE_BIN=/Applications/LibreOffice.app/Contents/MacOS/soffice
[api] 2025-08-24 22:08:31 preflight: importing app.main ...
[api] 2025-08-24 22:08:31 src/ exists; listing packages:
[api]  total 240
[api]  drwxr-xr-x  25 omair  staff    800 Aug 21 22:43 .
[api]  drwxr-xr-x@ 23 omair  staff    736 Aug 24 22:08 ..
[api]  -rw-r--r--@  1 omair  staff   6148 Aug 17 21:40 .DS_Store
[api]  -rw-r--r--   1 omair  staff    302 Aug 18 12:11 .dockerignore
[api]  drwxr-xr-x   3 omair  staff     96 Aug 12 19:53 .github
[api]  -rw-r--r--   1 omair  staff    416 Aug 12 19:53 .gitignore
[api]  drwxr-xr-x   6 omair  staff    192 Aug 20 13:25 .pytest_cache
[api]  -rw-r--r--   1 omair  staff   1077 Aug 18 10:06 Dockerfile
[api]  -rw-r--r--   1 omair  staff   1350 Aug 18 10:13 Makefile
[api]  -rw-r--r--   1 omair  staff   4396 Aug 18 09:44 README.md
[api]  drwxr-xr-x   3 omair  staff     96 Aug 19 13:06 __pycache__
[api]  drwxr-xr-x  19 omair  staff    608 Aug 24 00:14 app
[api]  drwxr-xr-x   3 omair  staff     96 Aug 15 09:54 artifacts
[api]  drwxr-xr-x   3 omair  staff     96 Aug 12 19:53 charts
[api]  drwxr-xr-x   3 omair  staff     96 Aug 14 15:14 config
[api]  drwxr-xr-x   4 omair  staff    128 Aug 12 19:53 db
[api]  drwxr-xr-x   5 omair  staff    160 Aug 18 10:03 infra
[api]  drwxr-xr-x   4 omair  staff    128 Aug 12 19:53 logs
[api]  -rw-r--r--   1 omair  staff    276 Aug 12 19:53 package.json
[api]  -rw-r--r--   1 omair  staff    736 Aug 18 10:13 replacements.txt
[api]  -rw-r--r--@  1 omair  staff   1228 Aug 23 22:52 requirements.txt
[api]  -rw-r--r--   1 omair  staff    646 Aug 19 13:05 run_server.py
[api]  -rw-r--r--   1 omair  staff  36044 Aug 18 09:44 sample.pptx
[api]  -rw-r--r--   1 omair  staff  33546 Aug 18 09:44 test.pptx
[api]  drwxr-xr-x   4 omair  staff    128 Aug 20 13:25 tests
[api]  total 32
[api]  drwxr-xr-x  19 omair  staff   608 Aug 24 00:14 .
[api]  drwxr-xr-x  25 omair  staff   800 Aug 21 22:43 ..
[api]  -rw-r--r--@  1 omair  staff  8196 Aug 20 09:47 .DS_Store
[api]  -rw-r--r--   1 omair  staff     0 Aug 12 19:53 __init__.py
[api]  drwxr-xr-x   4 omair  staff   128 Aug 24 16:58 __pycache__
[api]  drwxr-xr-x   6 omair  staff   192 Aug 12 19:53 agents
[api]  drwxr-xr-x   4 omair  staff   128 Aug 24 16:57 api
[api]  drwxr-xr-x  11 omair  staff   352 Aug 23 22:59 core
[api]  drwxr-xr-x@ 19 omair  staff   608 Aug 23 23:01 kernel
[api]  -rw-r--r--   1 omair  staff  2357 Aug 24 16:58 main.py
[api]  drwxr-xr-x   5 omair  staff   160 Aug 20 13:31 memory
[api]  drwxr-xr-x  10 omair  staff   320 Aug 20 13:31 models
[api]  drwxr-xr-x@  6 omair  staff   192 Aug 20 13:30 ops
[api]  drwxr-xr-x@  4 omair  staff   128 Aug 23 04:33 plugins
[api]  drwxr-xr-x  11 omair  staff   352 Aug 24 20:58 server
[api]  drwxr-xr-x  21 omair  staff   672 Aug 23 23:00 services
[api]  drwxr-xr-x  11 omair  staff   352 Aug 20 13:30 tools
[api]  drwxr-xr-x   3 omair  staff    96 Aug 23 05:11 utils
[api]  drwxr-xr-x   6 omair  staff   192 Aug 23 23:06 workers
/Users/omair/apisharayeh/.venv/lib/python3.12/site-packages/opentelemetry/instrumentation/dependencies.py:4: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import (
[api] python: 3.12.7 | packaged by Anaconda, Inc. | (main, Oct  4 2024, 08:22:19) [Clang 14.0.6 ]
[api] sys.path: [
  "",
  "/Users/omair/apisharayeh/src",
  "/Users/omair/apisharayeh",
  "/opt/anaconda3/lib/python312.zip",
  "/opt/anaconda3/lib/python3.12",
  "/opt/anaconda3/lib/python3.12/lib-dynload",
  "/Users/omair/apisharayeh/.venv/lib/python3.12/site-packages"
]
[api] preflight import: OK
/Users/omair/apisharayeh/.venv/lib/python3.12/site-packages/opentelemetry/instrumentation/dependencies.py:4: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import (
INFO:     Started server process [83071]
INFO:     Waiting for application startup.
INFO:app.kernel.plugins.loader:Plugin registry refreshed: 2 service(s) loaded from /Users/omair/apisharayeh/plugins
INFO:app.kernel.plugins.loader:Plugin registry refreshed: 2 service(s) loaded from /Users/omair/apisharayeh/plugins
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8081 (Press CTRL+C to quit)
INFO:app.kernel.plugins.loader:Plugin registry refreshed: 2 service(s) loaded from /Users/omair/apisharayeh/plugins
INFO:     127.0.0.1:51290 - "GET /health HTTP/1.1" 200 OK
[32m[run] API is up.[0m
[36m[plugins] syncing manifests for demo-tenant (slides only) ...[0m
[1/2] Ensuring schema, syncing manifests from ./plugins for tenant=demo-tenant â€¦
 - Loaded 2 manifest(s) from ./plugins
 - Upserted 2 into plugin_registry
 - Enabled/updated 2 for tenant 'demo-tenant'
 - Tenant 'demo-tenant' now has 9 enabled service(s)
[2/2] Verify via API (optional) â€¦
{
  "services": [
    {
      "id": "slides.author",
      "name": "Slides: Authoring",
      "version": "0.1.0",
      "runtime": "dsl"
    },
    {
      "id": "slides.generate",
      "name": "Slides: Generate",
      "version": "0.1.0",
      "runtime": "dsl"
    }
  ]
}
Done.
[32m[plugins] slides.generate is enabled.[0m
[36m[test] submitting slides.generate job (slides_count=6) ...[0m
[36mJOB_ID: 5aeae557-3d61-4550-a75b-1a4a74e5a444[0m
[2m  stream: curl -N "http://localhost:8081/v1/jobs/5aeae557-3d61-4550-a75b-1a4a74e5a444/events"[0m
[36m[test] waiting for artifact URL (max 120s) ... (SSE â†’ logs/sse-5aeae557-3d61-4550-a75b-1a4a74e5a444.log)[0m
[36m[test] artifact: http://localhost:8081/artifacts/prj_e50a6b3a/export/presentation.pdf[0m
[32m[test] PDF verified (36452 bytes) â†’ artifacts/slides-5aeae557-3d61-4550-a75b-1a4a74e5a444.pdf[0m
[32m[DONE] end-to-end OK.[0m
