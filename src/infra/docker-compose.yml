version: "3.9"\nservices:\n  api:\n    build:\n      context: ..\n      dockerfile: infra/docker/Dockerfile.api\n    env_file:\n    environment:\n      - OTEL_EXPORTER_OTLP_ENDPOINT=${OTEL_EXPORTER_OTLP_ENDPOINT}\n      - OTEL_EXPORTER_OTLP_PROTOCOL=${OTEL_EXPORTER_OTLP_PROTOCOL}\n      - ../.env\n    ports:\n      - "8080:8080"\n    depends_on:\n      - redis\n      - db\n  worker:\n    build:\n      context: ..\n      dockerfile: infra/docker/Dockerfile.worker\n    env_file:\n      - ../.env\n    depends_on:\n      - redis\n      - db\n  redis:\n    image: redis/redis-stack:latest\n    ports:\n      - "6379:6379"\n  db:\n    image: postgres:15\n    environment:\n      POSTGRES_PASSWORD: postgres\n      POSTGRES_DB: agentic\n    ports:\n      - "5432:5432"\n\n  prometheus:\n    image: prom/prometheus:latest\n    volumes:\n      - ./observability/prometheus.yml:/etc/prometheus/prometheus.yml:ro\n    ports:\n      - "9090:9090"\n  loki:\n    image: grafana/loki:2.9.8\n    command: -config.file=/etc/loki/local-config.yaml\n    volumes:\n      - ./observability/loki-config.yml:/etc/loki/local-config.yaml:ro\n    ports:\n      - "3100:3100"\n  promtail:\n    image: grafana/promtail:2.9.8\n    volumes:\n      - ./observability/promtail-config.yml:/etc/promtail/config.yml:ro\n      - /var/lib/docker/containers:/var/lib/docker/containers:ro\n    command: -config.file=/etc/promtail/config.yml\n  grafana:\n    image: grafana/grafana:10.4.5\n    environment:\n      - GF_AUTH_ANONYMOUS_ENABLED=true\n      - GF_AUTH_ANONYMOUS_ORG_ROLE=Admin\n    volumes:\n      - ./observability/grafana/provisioning:/etc/grafana/provisioning\n    ports:\n      - "3000:3000"\n\n  tempo:\n    image: grafana/tempo:2.4.1\n    volumes:\n      - ./observability/tempo.yaml:/etc/tempo.yaml:ro\n    command: ["-config.file=/etc/tempo.yaml"]\n    ports:\n      - "3200:3200"\n      - "4317:4317"